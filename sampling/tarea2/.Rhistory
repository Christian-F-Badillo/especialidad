OCUP_CON1 == 3 ~ "Trabajadores auxiliares en actividades administrativas",
OCUP_CON1 == 4 ~ "Comerciantes, empleados en ventas y agentes de ventas",
OCUP_CON1 == 5 ~ "Trabajadores en servicios personales y vigilancia",
OCUP_CON1 == 6 ~ "Trabajadores en actividades agrícolas, ganaderas, forestales, caza y pesca",
OCUP_CON1 == 7 ~ "Trabajadores artesanales",
OCUP_CON1 == 8 ~ "Operadores de maquinaria industrial, ensambladores, choferes y transporte",
OCUP_CON1 == 9 ~ "Trabajadores en actividades elementales y de apoyo",
OCUP_CON1 == 10 ~ "Busca trabajo",
OCUP_CON1 == 11 ~ "No trabaja",
OCUP_CON1 == 97 ~ "No aplica a menores de 5 años",
OCUP_CON1 == 98 ~ "Insuficientemente especificada",
OCUP_CON1 == 99 ~ "No especificada",
TRUE ~ NA_character_
),
act_laboral2 = case_when(
OCUP_CON2 == 1 ~ "Funcionarios, directores y jefes",
OCUP_CON2 == 2 ~ "Profesionistas y técnicos",
OCUP_CON2 == 3 ~ "Trabajadores auxiliares en actividades administrativas",
OCUP_CON2 == 4 ~ "Comerciantes, empleados en ventas y agentes de ventas",
OCUP_CON2 == 5 ~ "Trabajadores en servicios personales y vigilancia",
OCUP_CON2 == 6 ~ "Trabajadores en actividades agrícolas, ganaderas, forestales, caza y pesca",
OCUP_CON2 == 7 ~ "Trabajadores artesanales",
OCUP_CON2 == 8 ~ "Operadores de maquinaria industrial, ensambladores, choferes y transporte",
OCUP_CON2 == 9 ~ "Trabajadores en actividades elementales y de apoyo",
OCUP_CON2 == 10 ~ "Busca trabajo",
OCUP_CON2 == 11 ~ "No trabaja",
OCUP_CON2 == 97 ~ "No aplica a menores de 5 años",
OCUP_CON2 == 98 ~ "Insuficientemente especificada",
OCUP_CON2 == 99 ~ "No especificada",
TRUE ~ NA_character_
))
activ_laboral <- conteo_actlaboral %>%
pivot_longer(cols = c(act_laboral1, act_laboral2),
values_to = "actividad_laboral",
values_drop_na = T) %>%
#Agregar la columna de abreviaturas
mutate(abreviatura = recode(actividad_laboral, !!!mapa_abreviaturas)) %>%
group_by(abreviatura, actividad_laboral ) %>%
summarise(cantidad = n(), .groups = "drop")
knitr::kable(activ_laboral,
caption="Actividad laboral de los contrayentes",
col.names = c("Abreviatura", "Actividad Laboral", "Total"),
align = "clc")
#| echo: false
#| fig-cap: "Frecuencia de cada actividad laboral de los contrayentes."
ggplot(activ_laboral, aes(x= abreviatura, y = cantidad))+
geom_bar(stat="identity", fill = "forestgreen", color = "black")+
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust = 1))+
labs(
x = "Actividad",
y= "Cantidad")
#| echo: false
activ_laboral <- conteo_actlaboral %>%
pivot_longer(cols = c(act_laboral1, act_laboral2),
values_to = "actividad_laboral",
values_drop_na = T) %>%
#Agregar la columna de abreviaturas
mutate(abreviatura = recode(actividad_laboral, !!!mapa_abreviaturas), estado = estados[ENT_REGIS]) %>%
group_by(estado, ENT_REGIS, abreviatura) %>%
summarise(cantidad = n(), .groups = "drop")
knitr::kable(head(activ_laboral, 12),
caption="Actividad laboral de los contrayentes por estado (primeras obs.).",
col.names = c("Estado", "No. Estado", "Abreviatura", "Total"),
align = "cclc")
#| echo: false
#| fig-cap: "Frecuencia de la actividad laboral de los contrayentes por estado."
#| fig-width: 16
#| fig-height: 16
ggplot(activ_laboral, aes(x = factor(estado, levels = unique(estado)), y = cantidad))+
geom_bar(stat ="identity", fill = "forestgreen", col ="black")+
facet_wrap(~ abreviatura, nrow = 4, ncol = 4, scales = "free") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, hjust= 1))+
labs(
x = "Estado",
y = "Total")
#| echo: false
escolaridad_abrv <- c("SinE", "1-3 Prim", "4-5 Prim", "Primaria",
"Sec", "Prepa", "Prof", "Otra", "NE")
mapa_escolaridad <- c("Sin escolaridad" = "SinE",
"1 a 3 años de primaria" = "1-3 Prim",
"4 a 5 años de primaria" = "4-5 Prim",
"Primaria completa" = "Primaria",
"Secundaria o equivalente" = "Sec",
"Preparatoria o equivalente" = "Prepa",
"Profesional" = "Prof",
"Otra"= "Otra",
"No especificada" = "NE")
conteo_escolaridad<- imp_datos17 %>%
mutate(escolaridad1 = case_when(
ESCOL_CON1 == 1 ~ "Sin escolaridad",
ESCOL_CON1 == 2 ~ "1 a 3 años de primaria",
ESCOL_CON1 == 3 ~ "4 a 5 años de primaria",
ESCOL_CON1 == 4  ~ "Primaria completa",
ESCOL_CON1 == 5 ~ "Secundaria o equivalente",
ESCOL_CON1 == 6 ~ "Preparatoria o equivalente",
ESCOL_CON1 == 7 ~ "Profesional",
ESCOL_CON1 == 8 ~ "Otra",
ESCOL_CON1 == 9 ~ "No especificada",
TRUE ~ NA_character_
), escolaridad2 = case_when(
ESCOL_CON2 == 1 ~ "Sin escolaridad",
ESCOL_CON2 == 2 ~ "1 a 3 años de primaria",
ESCOL_CON2 == 3 ~ "4 a 5 años de primaria",
ESCOL_CON2 == 4  ~ "Primaria completa",
ESCOL_CON2 == 5 ~ "Secundaria o equivalente",
ESCOL_CON2 == 6 ~ "Preparatoria o equivalente",
ESCOL_CON2 == 7 ~ "Profesional",
ESCOL_CON2 == 8 ~ "Otra",
ESCOL_CON2 == 9 ~ "No especificada",
TRUE ~ NA_character_
))
escolaridad <- conteo_escolaridad %>%
pivot_longer(cols = c(escolaridad1, escolaridad2),
values_to = "escolaridad",
values_drop_na = T) %>%
mutate(escolaridad_abrv = recode(escolaridad, !!!mapa_escolaridad)) %>%
group_by(escolaridad_abrv, escolaridad) %>%
summarise(cantidad = n(), .groups = "drop")
knitr::kable(escolaridad,
caption = "Nivel de escolaridad de los contrayentes",
col.names = c("Abreviación", "Escolaridad", "Total"),
align = "clc")
#| echo: false
#| fig-cap: "Nivel de escolaridad de los contrayentes."
ggplot(escolaridad, aes(x= escolaridad_abrv, y = cantidad))+
geom_bar(stat ="identity", fill = "forestgreen", col ="black")+
#facet_wrap(~ abreviatura, nrow = 4, ncol = 4) +
theme_minimal()+
theme(axis.text.x = element_text(angle = 45, hjust= 1))+
labs(
x = "Escolaridad",
y = "Total")
#| echo: false
escolaridad <- conteo_escolaridad %>%
pivot_longer(cols = c(escolaridad1, escolaridad2),
values_to = "escolaridad",
values_drop_na = T) %>%
mutate(escolaridad_abrv = recode(escolaridad, !!!mapa_escolaridad),
estado = estados[ENT_REGIS]) %>%
group_by(ENT_REGIS, estado, escolaridad_abrv) %>%
summarise(cantidad = n(), .groups = "drop")
knitr::kable(escolaridad$Cantidad,
caption="Escolaridad de los contrayentes por estado (primeras obs.).",
col.names = c("No. Estado", "Estado", "Abreviatura", "Total"),
align = "cclc")
#| echo: false
escolaridad <- conteo_escolaridad %>%
pivot_longer(cols = c(escolaridad1, escolaridad2),
values_to = "escolaridad",
values_drop_na = T) %>%
mutate(escolaridad_abrv = recode(escolaridad, !!!mapa_escolaridad),
estado = estados[ENT_REGIS]) %>%
group_by(ENT_REGIS, estado, escolaridad_abrv) %>%
summarise(cantidad = n(), .groups = "drop")
knitr::kable(escolaridad$Cantidad)
# caption="Escolaridad de los contrayentes por estado (primeras obs.).",
# col.names = c("No. Estado", "Estado", "Abreviatura", "Total"),
# align = "cclc")
escolaridad$Cantidad
escolaridad$cantidad
escolaridad
escolaridad$cantidad
print(escolaridad$cantidad)
cat(escolaridad$cantidad)
cat(escolaridad$cantidad, sep = ", ")
Reales <- c(4, 3, 1, 159, 30, 161, 177, 1, 14, 3, 375, 3, 207, 119, 245,
286, 14, 2, 49, 6, 81, 44, 2, 21, 4, 2, 13, 81, 25, 87, 102,
3, 6, 143, 3, 321, 52, 337, 340, 6, 1, 2, 4, 1, 75, 22, 80,
59, 2, 33, 71, 85, 2, 374, 337, 306, 454, 90, 7, 11, 197, 11,
263, 127, 342, 300, 4, 56, 9, 19, 675, 68, 815, 621, 3, 3, 5,
87, 7, 130, 38, 97, 176, 3, 25, 15, 530, 12, 431, 274, 324, 742,
9, 24, 26, 88, 167, 272, 158, 205, 321, 17, 2, 4, 89, 152, 84, 207,
192, 12, 27, 21, 113, 1, 859, 298, 874, 796, 21, 26, 22, 198, 17,
1618, 453, 1084, 1539, 31, 12, 16, 327, 2, 367, 201, 350, 445, 18,
6, 2, 44, 16, 166, 42, 217, 167, 10, 58, 63, 25, 150, 62, 36, 3, 1,
633, 24, 326, 136, 476, 434, 3, 17, 6, 302, 247, 240, 380, 24, 22, 9,
373, 180, 433, 328, 27, 4, 2, 6, 156, 60, 255, 207, 8, 3, 2, 129, 280,
47, 217, 141, 3, 8, 4, 79, 4, 233, 72, 196, 259, 1, 17, 16, 177, 316,
63, 384, 173, 6, 12, 22, 302, 106, 341, 356, 3, 9, 12, 3, 36, 283, 45,
173, 203, 10, 20, 248, 2, 244, 91, 196, 246, 5, 8, 2, 141, 22, 102, 93,
2, 67, 38, 67, 9, 756, 323, 546, 506, 44, 11, 5, 104, 156, 67, 166, 212,
7, 6, 4, 24, 1, 158, 62, 160, 208, 17)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Escolaridad)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Entidad)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Entidad, Escolaridad)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Abreviacion)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Entidad,  Abreviacion)
mutate(Abreviacion = recode(Escol.Name, !!!mapa_escolaridad)) %>%
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
mutate(Escol.Name = case_when(
Escolaridad == 1 ~ "Sin escolaridad",
Escolaridad == 2 ~ "1 a 3 años de primaria",
Escolaridad == 3 ~ "4 a 5 años de primaria",
Escolaridad == 4  ~ "Primaria completa",
Escolaridad == 5 ~ "Secundaria o equivalente",
Escolaridad == 6 ~ "Preparatoria o equivalente",
Escolaridad == 7 ~ "Profesional",
Escolaridad == 8 ~ "Otra",
Escolaridad == 9 ~ "No especificada",
TRUE ~ NA_character_ )) %>%
mutate(Abreviacion = recode(Escol.Name, !!!mapa_escolaridad)) %>%
mutate(Escol.Name = factor(Escol.Name, levels = c("Sin escolaridad", "1 a 3 años de primaria", "4 a 5 años de primaria",
"Primaria completa", "Secundaria o equivalente", "Preparatoria o equivalente",
"Profesional", "Otra", "No especificada"), ordered = T))
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
mutate(Escol.Name = case_when(
Escolaridad == 1 ~ "Sin escolaridad",
Escolaridad == 2 ~ "1 a 3 años de primaria",
Escolaridad == 3 ~ "4 a 5 años de primaria",
Escolaridad == 4  ~ "Primaria completa",
Escolaridad == 5 ~ "Secundaria o equivalente",
Escolaridad == 6 ~ "Preparatoria o equivalente",
Escolaridad == 7 ~ "Profesional",
Escolaridad == 8 ~ "Otra",
Escolaridad == 9 ~ "No especificada",
TRUE ~ NA_character_ )) %>%
mutate(Abreviacion = recode(Escol.Name, !!!mapa_escolaridad)) %>%
mutate(Escol.Name = factor(Escol.Name, levels = c("Sin escolaridad", "1 a 3 años de primaria", "4 a 5 años de primaria",
"Primaria completa", "Secundaria o equivalente", "Preparatoria o equivalente",
"Profesional", "Otra", "No especificada"), ordered = T))
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
mutate(Escol.Name = case_when(
Escolaridad == 1 ~ "Sin escolaridad",
Escolaridad == 2 ~ "1 a 3 años de primaria",
Escolaridad == 3 ~ "4 a 5 años de primaria",
Escolaridad == 4  ~ "Primaria completa",
Escolaridad == 5 ~ "Secundaria o equivalente",
Escolaridad == 6 ~ "Preparatoria o equivalente",
Escolaridad == 7 ~ "Profesional",
Escolaridad == 8 ~ "Otra",
Escolaridad == 9 ~ "No especificada",
TRUE ~ NA_character_ )) %>%
mutate(Abreviacion = recode(Escol.Name, !!!mapa_escolaridad)) %>%
mutate(Escol.Name = factor(Escol.Name, levels = c("1 a 3 años de primaria", "4 a 5 años de primaria",
"No especificada","Otra", "Preparatoria o equivalente",
"Primaria completa", "Profesional", "Secundaria o equivalente",
"Sin escolaridad"), ordered = T))
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Entidad,  Escolaridad)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Entidad,  Escol.Name)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Escol.Name)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Entidad, Escol.Name)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Escol.Name, Entidad)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
group_by(Escol.Name, Entidad)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
order_by(Escol.Name)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
order_by(Entidad, Escol.Name)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
arrange(Escol.Name)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
arrange(Escol.Name, Entidad)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
arrange(Entidad, Escol.Name)
Estado <- rep(estados, each = 9)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
arrange(Entidad, Escol.Name) %>%
mutate(Estado = Estado) %>%
mutate(Real.Val = Reales)
#- ---------------------------------------------------------------------------------------------------------------
#- Escolaridad Contrayentes por Entidad Federativa
Esc.p.entidad <- sample[c("ENT_REGIS", "ESCOL_CON1")]
Esc.p <- sample[c("ENT_REGIS", "ESCOL_CON2")]
colnames(Esc.p.entidad) <- c("Entidad", "Escolaridad")
colnames(Esc.p) <- c("Entidad", "Escolaridad")
Esc.p.entidad <- rbind(Esc.p.entidad, Esc.p)
Esc.p.entidad <- cbind(Esc.p.entidad, N)
Esc.p.entidad <- as.data.frame(Esc.p.entidad)
Esc.p.entidad$Escolaridad <- factor(Esc.p.entidad$Escolaridad, levels = unique(Esc.p.entidad$Escolaridad), ordered = T)
View(Esc.p.entidad)
disenio <- svydesign(id=~1, fpc=~N, data=Esc.p.entidad)
total.esc.p.entidad <- svybys(~Escolaridad, bys = ~Entidad, design = disenio, FUN = svytotal)
df.total.escpent <- as.data.frame(total.esc.p.entidad)
estados <- c("Ags", "BC", "BCS", "Camp",  "Coah", "Col", "Chis", "Chih", "CDMX",  "Dgo", "Gto", "Gro",
"Hgo", "Jal", "Mex", "Mich", "Mor", "Nay", "NL", "Oax", "Pue", "Qro", "QR", "SLP", "Sin",
"Son", "Tab", "Tamps", "Tlax", "Ver", "Yuc", "Zac")
escolaridad_abrv <- c("SinE", "1-3 Prim", "4-5 Prim", "Primaria",
"Sec", "Prepa", "Prof", "Otra", "NE")
mapa_escolaridad <- c("Sin escolaridad" = "SinE",
"1 a 3 años de primaria" = "1-3 Prim",
"4 a 5 años de primaria" = "4-5 Prim",
"Primaria completa" = "Primaria",
"Secundaria o equivalente" = "Sec",
"Preparatoria o equivalente" = "Prepa",
"Profesional" = "Prof",
"Otra"= "Otra",
"No especificada" = "NE")
Entidad <- rep(df.total.escpent$Entidad, 9)
Esc.code <- rep(x = 1:9, each = 32)
Escol.names <- vector(length = 9)
se.Escol.names <- vector(length = 9)
for (i in 1:9){
Escol.names[i] <- paste("Escolaridad", i, sep = "")
se.Escol.names[i] <- paste("se.Escolaridad", i, sep="")
}
Escolaridad <- as.numeric(unlist(df.total.escpent[Escol.names]))
SE.Escolaridad <- as.numeric(unlist(df.total.escpent[se.Escol.names]))
CI.L <- Escolaridad - z * SE.Escolaridad
CI.U <- Escolaridad + z * SE.Escolaridad
Esc.Total.by.Ent <- data.frame(
Entidad, Escolaridad = Esc.code, Total = Escolaridad, CI.L, CI.U
)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
mutate(Escol.Name = case_when(
Escolaridad == 1 ~ "Sin escolaridad",
Escolaridad == 2 ~ "1 a 3 años de primaria",
Escolaridad == 3 ~ "4 a 5 años de primaria",
Escolaridad == 4  ~ "Primaria completa",
Escolaridad == 5 ~ "Secundaria o equivalente",
Escolaridad == 6 ~ "Preparatoria o equivalente",
Escolaridad == 7 ~ "Profesional",
Escolaridad == 8 ~ "Otra",
Escolaridad == 9 ~ "No especificada",
TRUE ~ NA_character_ )) %>%
mutate(Abreviacion = recode(Escol.Name, !!!mapa_escolaridad)) %>%
mutate(Escol.Name = factor(Escol.Name, levels = c("1 a 3 años de primaria", "4 a 5 años de primaria",
"No especificada","Otra", "Preparatoria o equivalente",
"Primaria completa", "Profesional", "Secundaria o equivalente",
"Sin escolaridad"), ordered = T))
Reales <- c(4, 3, 1, 159, 30, 161, 177, 1, 14, 3, 375, 3, 207, 119, 245,
286, 14, 2, 49, 6, 81, 44, 2, 21, 4, 2, 13, 81, 25, 87, 102,
3, 6, 143, 3, 321, 52, 337, 340, 6, 1, 2, 4, 1, 75, 22, 80,
59, 2, 33, 71, 85, 2, 374, 337, 306, 454, 90, 7, 11, 197, 11,
263, 127, 342, 300, 4, 56, 9, 19, 675, 68, 815, 621, 3, 3, 5,
87, 7, 130, 38, 97, 176, 3, 25, 15, 530, 12, 431, 274, 324, 742,
9, 24, 26, 88, 167, 272, 158, 205, 321, 17, 2, 4, 89, 152, 84, 207,
192, 12, 27, 21, 113, 1, 859, 298, 874, 796, 21, 26, 22, 198, 17,
1618, 453, 1084, 1539, 31, 12, 16, 327, 2, 367, 201, 350, 445, 18,
6, 2, 44, 16, 166, 42, 217, 167, 10, 58, 63, 25, 150, 62, 36, 3, 1,
633, 24, 326, 136, 476, 434, 3, 17, 6, 302, 247, 240, 380, 24, 22, 9,
373, 180, 433, 328, 27, 4, 2, 6, 156, 60, 255, 207, 8, 3, 2, 129, 280,
47, 217, 141, 3, 8, 4, 79, 4, 233, 72, 196, 259, 1, 17, 16, 177, 316,
63, 384, 173, 6, 12, 22, 302, 106, 341, 356, 3, 9, 12, 3, 36, 283, 45,
173, 203, 10, 20, 248, 2, 244, 91, 196, 246, 5, 8, 2, 141, 22, 102, 93,
2, 67, 38, 67, 9, 756, 323, 546, 506, 44, 11, 5, 104, 156, 67, 166, 212,
7, 6, 4, 24, 1, 158, 62, 160, 208, 17)
Estado <- rep(estados, each = 9)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
arrange(Entidad, Escol.Name) %>%
mutate(Estado = Estado) %>%
mutate(Real.Val = Reales)
Reales <- c(4, 3, 1, 159, 30, 161, 177, 1, 14, 3, 375, 3, 207, 119, 245,
286, 14, 2, 49, 6, 81, 44, 2, 21, 4, 2, 13, 81, 25, 87, 102,
3, 6, 143, 3, 321, 52, 337, 340, 6, 1, 2, 4, 1, 75, 22, 80,
59, 2, 33, 71, 85, 2, 374, 337, 306, 454, 90, 7, 11, 197, 11,
263, 127, 342, 300, 4, 56, 9, 19, 675, 68, 815, 621, 3, 3, 5,
87, 7, 130, 38, 97, 176, 3, 25, 15, 530, 12, 431, 274, 324, 742,
9, 24, 26, 88, 167, 272, 158, 205, 321, 17, 2, 4, 89, 152, 84, 207,
192, 12, 27, 21, 113, 1, 859, 298, 874, 796, 21, 26, 22, 198, 17,
1618, 453, 1084, 1539, 31, 12, 16, 327, 2, 367, 201, 350, 445, 18,
6, 2, 44, 16, 166, 42, 217, 167, 10, 58, 63, 25, 150, 62, 36, 3, 1,
633, 24, 326, 136, 476, 434, 3, 17, 6, 302, 247, 240, 380, 24, 22, 9,
373, 180, 433, 328, 27, 4, 2, 6, 156, 60, 255, 207, 8, 3, 2, 129, 280,
47, 217, 141, 3, 8, 4, 79, 4, 233, 72, 196, 259, 1, 17, 16, 177, 316,
63, 384, 173, 6, 12, 22, 302, 106, 341, 356, 3, 9, 12, 3, 36, 283, 45,
173, 203, 10, 20, 248, 2, 244, 91, 196, 246, 5, 8, 2, 141, 22, 102, 93,
2, 67, 38, 67, 9, 756, 323, 546, 506, 44, 11, 5, 104, 156, 67, 166, 212,
7, 6, 4, 24, 1, 158, 62, 160, 208, 17, 0, 0, 0)
Estado <- rep(estados, each = 9)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
arrange(Entidad, Escol.Name) %>%
mutate(Estado = Estado) %>%
mutate(Real.Val = Reales)
Reales <- c(4, 3, 1, 159, 30, 161, 177, 1, 14, 3, 375, 3, 207, 119, 245,
286, 14, 2, 49, 6, 81, 44, 2, 21, 4, 2, 13, 81, 25, 87, 102,
3, 6, 143, 3, 321, 52, 337, 340, 6, 1, 2, 4, 1, 75, 22, 80,
59, 2, 33, 71, 85, 2, 374, 337, 306, 454, 90, 7, 11, 197, 11,
263, 127, 342, 300, 4, 56, 9, 19, 675, 68, 815, 621, 3, 3, 5,
87, 7, 130, 38, 97, 176, 3, 25, 15, 530, 12, 431, 274, 324, 742,
9, 24, 26, 88, 167, 272, 158, 205, 321, 17, 2, 4, 89, 152, 84, 207,
192, 12, 27, 21, 113, 1, 859, 298, 874, 796, 21, 26, 22, 198, 17,
1618, 453, 1084, 1539, 31, 12, 16, 327, 2, 367, 201, 350, 445, 18,
6, 2, 44, 16, 166, 42, 217, 167, 10, 58, 63, 25, 150, 62, 36, 3, 1,
633, 24, 326, 136, 476, 434, 3, 17, 6, 302, 247, 240, 380, 24, 22, 9,
373, 180, 433, 328, 27, 4, 2, 6, 156, 60, 255, 207, 8, 3, 2, 129, 280,
47, 217, 141, 3, 8, 4, 79, 4, 233, 72, 196, 259, 1, 17, 16, 177, 316,
63, 384, 173, 6, 12, 22, 302, 106, 341, 356, 3, 9, 12, 3, 36, 283, 45,
173, 203, 10, 20, 248, 2, 244, 91, 196, 246, 5, 8, 2, 141, 22, 102, 93,
2, 67, 38, 67, 9, 756, 323, 546, 506, 44, 11, 5, 104, 156, 67, 166, 212,
7, 6, 4, 24, 1, 158, 62, 160, 208, 17, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
Estado <- rep(estados, each = 9)
Esc.Total.by.Ent <- Esc.Total.by.Ent %>%
arrange(Entidad, Escol.Name) %>%
mutate(Estado = Estado) %>%
mutate(Real.Val = Reales)
ggplot(data = Esc.Total.by.Ent) +
geom_point(aes(x = Estado, y = val.real, colour = "blue"), size = 2.25) +
geom_point(aes(x = Estado, y = Total, colour = "yellowgreen"), size = 2.25) +
geom_errorbar(aes(ymin = CI.L, ymax = CI.U, x = abreviatura, colour = "yellowgreen")) +
facet_wrap(~Abreviacion, scales = "Free") +
labs(x = "Ocupación",
y = "Total",
title = "Ocupaciones de los contrayentes con IC del 95%") +
guides(colour = guide_legend(title = "")) +
scale_color_discrete(labels=c("Valor Real", "Valor Estimado")) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45))
ggplot(data = Esc.Total.by.Ent) +
geom_point(aes(x = Estado, y = val.real, colour = "blue"), size = 2.25) +
geom_point(aes(x = Estado, y = Total, colour = "yellowgreen"), size = 2.25) +
geom_errorbar(aes(ymin = CI.L, ymax = CI.U, x = abreviatura, colour = "yellowgreen")) +
facet_wrap(~Abreviacion, scales = "free") +
labs(x = "Ocupación",
y = "Total",
title = "Ocupaciones de los contrayentes con IC del 95%") +
guides(colour = guide_legend(title = "")) +
scale_color_discrete(labels=c("Valor Real", "Valor Estimado")) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45))
ggplot(data = Esc.Total.by.Ent) +
facet_wrap(~Abreviacion, scales = "free") +
geom_point(aes(x = Estado, y = val.real, colour = "blue"), size = 2.25) +
geom_point(aes(x = Estado, y = Total, colour = "yellowgreen"), size = 2.25) +
geom_errorbar(aes(ymin = CI.L, ymax = CI.U, x = abreviatura, colour = "yellowgreen")) +
labs(x = "Ocupación",
y = "Total",
title = "Ocupaciones de los contrayentes con IC del 95%") +
guides(colour = guide_legend(title = "")) +
scale_color_discrete(labels=c("Valor Real", "Valor Estimado")) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45))
ggplot(Esc.Total.by.Ent, aes(x= factor(Estado, levels = unique(Estado)), y = Total))+
geom_bar(stat ="identity", fill = "forestgreen", col ="black")+
facet_wrap(~ Escol.Name, nrow = 4, ncol = 4, scales = "free_y") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, hjust= 1))+
labs(
x = "Estado",
y = "Total")
ggplot(Esc.Total.by.Ent, aes(x= factor(Estado, levels = unique(Estado)), y = Total))+
geom_point()
ggplot(Esc.Total.by.Ent, aes(x= factor(Estado, levels = unique(Estado)), y = Total))+
geom_point() +
facet_wrap(~ Escol.Name, nrow = 4, ncol = 4, scales = "free_y") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, hjust= 1))+
labs(
x = "Estado",
y = "Total")
ggplot(Esc.Total.by.Ent, aes(x= factor(Estado, levels = unique(Estado)), y = Real.Val))+
geom_point() +
geom_point(aes(x = Estado, y = Total, colour = "yellowgreen"), size = 2.25) +
facet_wrap(~ Escol.Name, nrow = 4, ncol = 4, scales = "free_y") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, hjust= 1))+
labs(
x = "Estado",
y = "Total")
ggplot(Esc.Total.by.Ent, aes(x= factor(Estado, levels = unique(Estado)), y = Real.Val))+
geom_point() +
geom_point(aes(x = Estado, y = Total, colour = "yellowgreen"), size = 2.25) +
facet_wrap(~ Escol.Name, nrow = 9, ncol = 2, scales = "free_y") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, hjust= 1))+
labs(
x = "Estado",
y = "Total")
ggplot(Esc.Total.by.Ent, aes(x= factor(Estado, levels = unique(Estado)), y = Real.Val, colour = "blue"))+
geom_point() +
geom_point(aes(x = Estado, y = Total, colour = "yellowgreen"), size = 2.25) +
facet_wrap(~ Escol.Name, nrow = 9, ncol = 2, scales = "free_y") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, hjust= 1))+
labs(
x = "Estado",
y = "Total")
ggplot(Esc.Total.by.Ent, aes(x= factor(Estado, levels = unique(Estado)), y = Real.Val, colour = "blue"))+
geom_point() +
geom_point(aes(x = Estado, y = Total, colour = "yellowgreen"), size = 2.25) +
geom_errorbar(aes(ymin = CI.L, ymax = CI.U, x = abreviatura, colour = "yellowgreen")) +
facet_wrap(~ Escol.Name, nrow = 9, ncol = 2, scales = "free_y") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, hjust= 1))+
labs(
x = "Estado",
y = "Total")
ggplot(Esc.Total.by.Ent, aes(x= factor(Estado, levels = unique(Estado)), y = Real.Val, colour = "blue"))+
geom_point() +
geom_point(aes(x = Estado, y = Total, colour = "yellowgreen"), size = 2.25) +
geom_errorbar(aes(ymin = CI.L, ymax = CI.U, colour = "yellowgreen")) +
facet_wrap(~ Escol.Name, nrow = 9, ncol = 2, scales = "free_y") +
theme_minimal()+
theme(axis.text.x = element_text(angle = 90, hjust= 1))+
labs(
x = "Estado",
y = "Total")
ggplot(Esc.Total.by.Ent, aes(x= factor(Estado, levels = unique(Estado)), y = Real.Val, colour = "blue"))+
geom_point() +
geom_point(aes(x = Estado, y = Total, colour = "yellowgreen"), size = 2.25) +
geom_errorbar(aes(ymin = CI.L, ymax = CI.U, colour = "yellowgreen")) +
facet_wrap(~ Escol.Name, nrow = 9, ncol = 2, scales = "free_y") +
labs(x = "Estado",
y = "Total",
title = "Escolaridad de los Contrayentes con IC del 95%") +
guides(colour = guide_legend(title = "")) +
scale_color_discrete(labels=c("Valor Real", "Valor Estimado")) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45))
ls
